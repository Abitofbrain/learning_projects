# Восстановление золота из золотосодержащей руды

В нашем распоряжении данные с параметрами очистки золота на одном из золотообогащающих предприятий. Детальное описание параметров развернем на этапе `Обзор данных`

**Цель проекта:**

Необходимо подготовить модель машинного обучения, предсказывающую коэффициент восстановления золота из золотосодержащей руды.

**План работ:**

- 1. Подготовка данных
    - Откроем файлы и изучим их.
    - Проверим, что эффективность обогащения рассчитана правильно. Вычислим её на обучающей выборке для признака `rougher.output.recovery.` Найдите MAE между нашими расчётами и значением признака. Проанализируем результат.
    - Проанализируем признаки, недоступные в тестовой выборке.
    - Предобработаем и проведем разведочный анализ (EDA) данных

- 2. Статистический анализ данных.
    - Проанализируем как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки.
    - Сравним распределения размеров гранул сырья на обучающей и тестовой выборках. Если распределения сильно отличаются друг от друга, оценка модели будет неправильной.
    - Исследуем суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах.

- 3. Построение моделей.
    - Напишем функцию для вычисления итоговой метрики sMAPE.
    - Обучим разные модели и оценим их качество кросс-валидацией. Выберем лучшие модели и проверим их на тестовой выборке.


    В представленных нам данных содержалась информация о характеристиках и параметрах технологического процесса очистки золота на одном из золотообогащающих предприятий. На этих данных надо было провести статистический анализ и ответить на поставленные заказчиком вопросы и подготовить модели машинного обучения, предсказывающие коэффициент восстановления золота из золотосодержащей руды.

  Данные поступили в плохом качестве, разрозненные, со множеством пропусков и аномалий, со значениями, которые рассчитываются после завершения тех.процесса, а, значит, не годящимися для построения моделей значениями. Не смотря на это, проверено, что расчёт эффективности обогащения был рассчитан верно. С данными были проведены следующие манипуляции:

   - Столбцы переименованы в соответствие с требованием PEP8

   - Множественно содержались пропуски, их мы заменили по методу ffil, то есть последнее действительное значение записывали на следующее недействительное. Так мы учили рекомендацию заказчика, о том, что соседние значения по времени параметры часто похожи

   -  удалены аномалии в данных. Аномалиям мы приняли те записи, где суммарная масса всех веществ на  этапах равно нулю.

   Провели статистический анализ о содержании концентраций металлов на разных этапах очистки. Его результаты описаны в пункте 3.1 и 3.4.

  Убедились, что сравнение распределений размеров гранул схожи для обучающей и тестовой выборки.

  Провели анализ коррелирующих между собой признаков-предиктов и удалили сильно коррелирующие. Перед итоговым построением моделей провели масштабирование данных.

  Изучили несколько моделей, выбрали лучшие для своего этапа. Проверили их на адекватность Дамми-моделью. И получили на тестовой выборке:

  **Итоговое sMAPE = 6.61**

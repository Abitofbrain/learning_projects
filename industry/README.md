## В нашем распоряжении данные с параметрами обработки стали на металлургическом комбинате ООО «Так закаляем сталь». Необходимо оптимизировать производственные расходы путем уменьшения потребления электроэнергии на этапе обработки стали


**Цель проекта:**

Необходимо подготовить модель машинного обучения, предсказывающую темепратуру расплава стали на этапе достижения целевого химического состава. Целевой метрикой для нас определена средняя абсолютная ошибка MAE. По ТЗ её значение на тестовой выборке должно быть не больше 8.7


Все промежуточные выводы с детальным описанием выполненного, мы изложили в соответствующих разделах, с ними можно ознакомиться в п. 2.8 и п.3.7.


Данные нам поступили в удовлетворительном качестве в нескольких раздельных таблицах. Самым ключевым шагом на этапе подготовки данных являлось формирование итоговой сводной таблицы предиктов, в которую не должны были попасть пропуски, аномалии и не подходящие по ТЗ значения. При этом мы попытались сохранить максимум записей, так как понимали, что чем больше записей с реальными данными мы сможем сохранить, тем точней, в теории, должна работать наша модель. В итоге мы сохранили данные о 2325 партиях стали на 26 признаках-предиктах:
                    'first_temp', 'heat_count', 'total_work', 'bulk_1', 'bulk_2', 'bulk_3',
                     'bulk_4', 'bulk_5', 'bulk_6', 'bulk_7', 'bulk_8', 'bulk_10', 'bulk_11',
                     'bulk_12', 'bulk_13', 'bulk_14', 'bulk_15', 'wire_1', 'wire_2',
                      'wire_3', 'wire_4', 'wire_6', 'wire_7', 'wire_8', 'wire_9', 'gas'


В начале мы испытали линейную регрессию и случайный лес, результаты были ниже требуемых по ТЗ, но не ниже нашей цели МАЕ 6.0. Принято было решение исптытать одну из моделей градиентного бустинга. Остановились на регрессорной модели из библиотеки CatBoost. Глубокий подбор параметров дал нам значение **`МАЕ=5.99`** для тренировочной и тестовой выборки, что являлось результатом лучше поставленной нами цели. Финишной моделью стал `CatBoostRegressor` со следующими гиперпараметрами: `(loss_function="MAE", depth=4, l2_leaf_reg=8, learning_rate=0.05, iterations=900,  random_state=120922)`
